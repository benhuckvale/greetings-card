import{r as H,c as Ze,R as Z}from"./index.CxD2bX9x.js";var Le={exports:{}},At={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ve=H,Ke=Symbol.for("react.element"),Je=Symbol.for("react.fragment"),Qe=Object.prototype.hasOwnProperty,ti=Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ei={key:!0,ref:!0,__self:!0,__source:!0};function Me(g,h,f){var c,w={},P=null,L=null;f!==void 0&&(P=""+f),h.key!==void 0&&(P=""+h.key),h.ref!==void 0&&(L=h.ref);for(c in h)Qe.call(h,c)&&!ei.hasOwnProperty(c)&&(w[c]=h[c]);if(g&&g.defaultProps)for(c in h=g.defaultProps,h)w[c]===void 0&&(w[c]=h[c]);return{$$typeof:Ke,type:g,key:P,ref:L,props:w,_owner:ti.current}}At.Fragment=Je;At.jsx=Me;At.jsxs=Me;Le.exports=At;var T=Le.exports,jt={exports:{}};(function(g,h){(function(f,c){c(h)})(Ze,function(f){class c{constructor(t,e){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=e,this.nowDrawingDensity=this.createdDensity,this.render=t}setDensity(t){this.createdDensity=t,this.nowDrawingDensity=t}setDrawingDensity(t){this.nowDrawingDensity=t}setPosition(t){this.state.position=t}setAngle(t){this.state.angle=t}setArea(t){this.state.area=t}setHardDrawingAngle(t){this.state.hardDrawingAngle=t}setHardAngle(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}setOrientation(t){this.orientation=t}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class w extends c{constructor(t,e,i){super(t,i),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=e}draw(t){const e=this.render.getContext(),i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,o=this.render.getRect().height;e.save(),e.translate(i.x,i.y),e.beginPath();for(let r of this.state.area)r!==null&&(r=this.render.convertToGlobal(r),e.lineTo(r.x-i.x,r.y-i.y));e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,n,o):this.drawLoader(e,{x:0,y:0},n,o),e.restore()}simpleDraw(t){const e=this.render.getRect(),i=this.render.getContext(),n=e.pageWidth,o=e.height,r=t===1?e.left+e.pageWidth:e.left,d=e.top;this.isLoad?i.drawImage(this.image,r,d,n,o):this.drawLoader(i,{x:r,y:d},n,o)}drawLoader(t,e,i,n){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,i-1,n-1),t.stroke(),t.fill();const o={x:e.x+i/2,y:e.y+n/2};t.beginPath(),t.lineWidth=10,t.arc(o.x,o.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class P{constructor(t,e){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=e,this.app=t,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let e=0;e<this.pages.length;e++)this.portraitSpread.push([e]);let t=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([t]),t++);for(let e=t;e<this.pages.length;e+=2)e<this.pages.length-1?this.landscapeSpread.push([e,e+1]):(this.landscapeSpread.push([e]),this.pages[e].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(t){const e=this.getSpread();for(let i=0;i<e.length;i++)if(t===e[i][0]||t===e[i][1])return i;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}nextBy(t){const e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}prevBy(t){const e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}getFlippingPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e].newTemporaryCopy():this.pages[e-1];{const i=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return i.length===1||t===0?this.pages[i[0]]:this.pages[i[1]]}}getBottomPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e+1]:this.pages[e-1];{const i=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return i.length===1?this.pages[i[0]]:t===0?this.pages[i[1]]:this.pages[i[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(t=null){if(t===null&&(t=this.currentPageIndex),t<0||t>=this.pages.length)return;const e=this.getSpreadIndexByPage(t);e!==null&&(this.currentSpreadIndex=e,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}showSpread(){const t=this.getSpread()[this.currentSpreadIndex];t.length===2?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):this.render.getOrientation()==="landscape"&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}class L extends P{constructor(t,e,i){super(t,e),this.imagesHref=i}load(){for(const t of this.imagesHref){const e=new w(this.render,t,"soft");e.load(),this.pages.push(e)}this.createSpread()}}class y{static GetDistanceBetweenTwoPoint(t,e){return t===null||e===null?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static GetSegmentLength(t){return y.GetDistanceBetweenTwoPoint(t[0],t[1])}static GetAngleBetweenTwoLine(t,e){const i=t[0].y-t[1].y,n=e[0].y-e[1].y,o=t[1].x-t[0].x,r=e[1].x-e[0].x;return Math.acos((i*n+o*r)/(Math.sqrt(i*i+o*o)*Math.sqrt(n*n+r*r)))}static PointInRect(t,e){return e===null?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}static GetRotatedPoint(t,e,i){return{x:t.x*Math.cos(i)+t.y*Math.sin(i)+e.x,y:t.y*Math.cos(i)-t.x*Math.sin(i)+e.y}}static LimitPointToCircle(t,e,i){if(y.GetDistanceBetweenTwoPoint(t,i)<=e)return i;const n=t.x,o=t.y,r=i.x,d=i.y;let m=Math.sqrt(Math.pow(e,2)*Math.pow(n-r,2)/(Math.pow(n-r,2)+Math.pow(o-d,2)))+n;i.x<0&&(m*=-1);let E=(m-n)*(o-d)/(n-r)+o;return n-r+o===0&&(E=e),{x:m,y:E}}static GetIntersectBetweenTwoSegment(t,e,i){return y.PointInRect(t,y.GetIntersectBeetwenTwoLine(e,i))}static GetIntersectBeetwenTwoLine(t,e){const i=t[0].y-t[1].y,n=e[0].y-e[1].y,o=t[1].x-t[0].x,r=e[1].x-e[0].x,d=t[0].x*t[1].y-t[1].x*t[0].y,m=e[0].x*e[1].y-e[1].x*e[0].y,E=i*m-n*d,A=o*m-r*d,U=-(d*r-m*o)/(i*r-n*o),K=-(i*m-n*d)/(i*r-n*o);if(isFinite(U)&&isFinite(K))return{x:U,y:K};if(Math.abs(E-A)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(t,e){const i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y),o=Math.max(i,n),r=[t];function d(m,E,A,U,K){return E>m?m+K*(A/U):E<m?m-K*(A/U):m}for(let m=1;m<=o;m+=1)r.push({x:d(t.x,e.x,i,o,m),y:d(t.y,e.y,n,o,m)});return r}}class z extends c{constructor(t,e,i){super(t,i),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=e,this.element.classList.add("stf__item"),this.element.classList.add("--"+i)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new z(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(t){const e=t||this.nowDrawingDensity,i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,o=this.render.getRect().height;this.element.classList.remove("--simple");const r=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${n}px;
            height: ${o}px;
        `;e==="hard"?this.drawHard(r):this.drawSoft(i,r)}drawHard(t=""){const e=this.render.getRect().left+this.render.getRect().width/2,i=this.state.hardDrawingAngle,n=t+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${i}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${e}px, 0, 0) rotateY(${i}deg);`);this.element.style.cssText=n}drawSoft(t,e=""){let i="polygon( ";for(const o of this.state.area)if(o!==null){let r=this.render.getDirection()===1?{x:-o.x+this.state.position.x,y:o.y-this.state.position.y}:{x:o.x-this.state.position.x,y:o.y-this.state.position.y};r=y.GetRotatedPoint(r,{x:0,y:0},this.state.angle),i+=r.x+"px "+r.y+"px, "}i=i.slice(0,-2),i+=")";const n=e+`transform-origin: 0 0; clip-path: ${i}; -webkit-clip-path: ${i};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${t.x}px, ${t.y}px);`:`transform: translate3d(${t.x}px, ${t.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=n}simpleDraw(t){const e=this.render.getRect(),i=e.pageWidth,n=e.height,o=t===1?e.left+e.pageWidth:e.left,r=e.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${n}px; 
            left: ${o}px; 
            top: ${r}px; 
            width: ${i}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(t){super.setOrientation(t),this.element.classList.remove("--left","--right"),this.element.classList.add(t===1?"--right":"--left")}setDrawingDensity(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),super.setDrawingDensity(t)}}class _ extends P{constructor(t,e,i,n){super(t,e),this.element=i,this.pagesElement=n}load(){for(const t of this.pagesElement){const e=new z(this.render,t,t.dataset.density==="hard"?"hard":"soft");e.load(),this.pages.push(e)}this.createSpread()}}class B{constructor(t,e,i,n){this.direction=t,this.corner=e,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(i,10),this.pageHeight=parseInt(n,10)}calc(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const t=[];let e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),this.sideIntersectPoint===null?e=!0:(t.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(e=!1)),t.push(this.bottomIntersectPoint),(e||this.corner==="bottom")&&t.push(this.rect.bottomLeft),t}getBottomClipArea(){const t=[];return t.push(this.topIntersectPoint),this.corner==="top"?t.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?y.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):this.corner==="top"&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const t=y.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?t:Math.PI-t}calcAngleAndPosition(t){let e=t;if(this.updateAngleAndGeometry(e),e=this.corner==="top"?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}updateAngleAndGeometry(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}calculateAngle(t){const e=this.pageWidth-t.x+1,i=this.corner==="bottom"?this.pageHeight-t.y:t.y;let n=2*Math.acos(e/Math.sqrt(i*i+e*e));i<0&&(n=-n);const o=Math.PI-n;if(!isFinite(n)||o>=0&&o<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(n=-n),n}getPageRect(t){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}getRectFromBasePoint(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}getRotatedPoint(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}calculateIntersectPoint(t){const e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=y.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(t,e,i){let n=t;const o=y.LimitPointToCircle(e,this.pageWidth,n);n!==o&&(n=o,this.updateAngleAndGeometry(n));const r=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let d=this.rect.bottomRight,m=this.rect.topLeft;if(this.corner==="bottom"&&(d=this.rect.topRight,m=this.rect.bottomLeft),d.x<=0){const E=y.LimitPointToCircle(i,r,m);E!==n&&(n=E,this.updateAngleAndGeometry(n))}return n}getSegmentToShadowLine(){const t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class I{constructor(t,e){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=t,this.app=e}fold(t){this.setState("user_fold"),this.calc===null&&this.start(t),this.do(this.render.convertToPage(t))}flip(t){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(t)||(this.calc!==null&&this.render.finishAnimation(),!this.start(t)))return;const e=this.getBoundsRect();this.setState("flipping");const i=e.height/10,n=this.calc.getCorner()==="bottom"?e.height-i:i,o=this.calc.getCorner()==="bottom"?e.height:0;this.calc.calc({x:e.pageWidth-i,y:n}),this.animateFlippingTo({x:e.pageWidth-i,y:n},{x:-e.pageWidth,y:o},!0)}start(t){this.reset();const e=this.render.convertToBook(t),i=this.getBoundsRect(),n=this.getDirectionByPoint(e),o=e.y>=i.height/2?"bottom":"top";if(!this.checkDirection(n))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(n),this.bottomPage=this.app.getPageCollection().getBottomPage(n),this.render.getOrientation()==="landscape")if(n===1){const r=this.app.getPageCollection().nextBy(this.flippingPage);r!==null&&this.flippingPage.getDensity()!==r.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),r.setDrawingDensity("hard"))}else{const r=this.app.getPageCollection().prevBy(this.flippingPage);r!==null&&this.flippingPage.getDensity()!==r.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),r.setDrawingDensity("hard"))}return this.render.setDirection(n),this.calc=new B(n,o,i.pageWidth.toString(10),i.height.toString(10)),!0}catch{return!1}}do(t){if(this.calc!==null&&this.calc.calc(t)){const e=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*e)/100):this.flippingPage.setHardAngle(-90*(200-2*e)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),e,this.calc.getDirection())}}flipToPage(t,e){const i=this.app.getPageCollection().getCurrentSpreadIndex(),n=this.app.getPageCollection().getSpreadIndexByPage(t);try{n>i&&(this.app.getPageCollection().setCurrentSpreadIndex(n-1),this.flipNext(e)),n<i&&(this.app.getPageCollection().setCurrentSpreadIndex(n+1),this.flipPrev(e))}catch{}}flipNext(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:t==="top"?1:this.render.getRect().height-2})}flipPrev(t){this.flip({x:10,y:t==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const t=this.calc.getPosition(),e=this.getBoundsRect(),i=this.calc.getCorner()==="bottom"?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:i},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:i},!1)}showCorner(t){if(!this.checkState("read","fold_corner"))return;const e=this.getBoundsRect(),i=e.pageWidth;if(this.isPointOnCorners(t))if(this.calc===null){if(!this.start(t))return;this.setState("fold_corner"),this.calc.calc({x:i-1,y:1});const n=50,o=this.calc.getCorner()==="bottom"?e.height-1:1,r=this.calc.getCorner()==="bottom"?e.height-n:n;this.animateFlippingTo({x:i-1,y:o},{x:i-n,y:r},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(t,e,i,n=!0){const o=y.GetCordsFromTwoPoint(t,e),r=[];for(const m of o)r.push(()=>this.do(m));const d=this.getAnimationDuration(o.length);this.render.startAnimation(r,d,()=>{this.calc&&(i&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),n&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(t){this.state!==t&&(this.app.updateState(t),this.state=t)}getDirectionByPoint(t){const e=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(t.x-e.pageWidth<=e.width/5)return 1}else if(t.x<e.width/2)return 1;return 0}getAnimationDuration(t){const e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}checkDirection(t){return t===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...t){for(const e of t)if(this.state===e)return!0;return!1}isPointOnCorners(t){const e=this.getBoundsRect(),i=e.pageWidth,n=Math.sqrt(Math.pow(i,2)+Math.pow(e.height,2))/5,o=this.render.convertToBook(t);return o.x>0&&o.y>0&&o.x<e.width&&o.y<e.height&&(o.x<n||o.x>e.width-n)&&(o.y<n||o.y>e.height-n)}}class mt{constructor(t,e){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=e,this.app=t;const i=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=i.exec(window.navigator.userAgent)!==null}render(t){if(this.animation!==null){const e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}start(){this.update();const t=e=>{this.render(e),requestAnimationFrame(t)};requestAnimationFrame(t)}startAnimation(t,e,i){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:i,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}calculateBoundsRect(){let t="landscape";const e=this.getBlockWidth(),i=e/2,n=this.getBlockHeight()/2,o=this.setting.width/this.setting.height;let r=this.setting.width,d=this.setting.height,m=i-r;return this.setting.size==="stretch"?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t="portrait"),r=t==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,r>this.setting.maxWidth&&(r=this.setting.maxWidth),d=r/o,d>this.getBlockHeight()&&(d=this.getBlockHeight(),r=d*o),m=t==="portrait"?i-r/2-r:i-r):e<2*r&&this.app.getSettings().usePortrait&&(t="portrait",m=i-r/2-r),this.boundsRect={left:m,top:n-d/2,width:2*r,height:d,pageWidth:r},t}setShadowData(t,e,i,n){if(!this.app.getSettings().drawShadow)return;const o=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*i/100,opacity:(100-i)*o/100/100,direction:n,progress:2*i}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(t){this.pageRect=t}setDirection(t){this.direction=t}setRightPage(t){t!==null&&t.setOrientation(1),this.rightPage=t}setLeftPage(t){t!==null&&t.setOrientation(0),this.leftPage=t}setBottomPage(t){t!==null&&t.setOrientation(this.direction===1?0:1),this.bottomPage=t}setFlippingPage(t){t!==null&&t.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=t}convertToBook(t){const e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}isSafari(){return this.safari}convertToPage(t,e){e||(e=this.direction);const i=this.getRect();return{x:e===0?t.x-i.left-i.width/2:i.width/2-t.x+i.left,y:t.y-i.top}}convertToGlobal(t,e){if(e||(e=this.direction),t==null)return null;const i=this.getRect();return{x:e===0?t.x+i.left+i.width/2:i.width/2-t.x+i.left,y:t.y+i.top}}convertRectToGlobal(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}class tt extends mt{constructor(t,e,i){super(t,e),this.canvas=i,this.ctx=i.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const t=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}drawBookShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);const i={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(i.x,i.y);const n=this.ctx.createLinearGradient(0,0,e,0);n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),n.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),n.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),n.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}drawOuterShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const i=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),i.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),i.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}drawInnerShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(i.topLeft.x,i.topLeft.y),this.ctx.lineTo(i.topRight.x,i.topRight.y),this.ctx.lineTo(i.bottomRight.x,i.bottomRight.y),this.ctx.lineTo(i.bottomLeft.x,i.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const n=3*this.shadow.width/4,o=this.ctx.createLinearGradient(0,0,n,0);this.shadow.direction===0?(this.ctx.translate(-n,-100),o.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),o.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),o.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),o.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),o.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),o.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),o.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),o.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=o,this.ctx.fillRect(0,0,n,2*t.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class V{constructor(t,e,i){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=o=>{if(this.checkTarget(o.target)){const r=this.getMousePos(o.clientX,o.clientY);this.app.startUserTouch(r),o.preventDefault()}},this.onTouchStart=o=>{if(this.checkTarget(o.target)&&o.changedTouches.length>0){const r=o.changedTouches[0],d=this.getMousePos(r.clientX,r.clientY);this.touchPoint={point:d,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(d)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||o.preventDefault()}},this.onMouseUp=o=>{const r=this.getMousePos(o.clientX,o.clientY);this.app.userStop(r)},this.onMouseMove=o=>{const r=this.getMousePos(o.clientX,o.clientY);this.app.userMove(r,!1)},this.onTouchMove=o=>{if(o.changedTouches.length>0){const r=o.changedTouches[0],d=this.getMousePos(r.clientX,r.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-d.x)>10||this.app.getState()!=="read")&&o.cancelable&&this.app.userMove(d,!0),this.app.getState()!=="read"&&o.preventDefault()):this.app.userMove(d,!0)}},this.onTouchEnd=o=>{if(o.changedTouches.length>0){const r=o.changedTouches[0],d=this.getMousePos(r.clientX,r.clientY);let m=!1;if(this.touchPoint!==null){const E=d.x-this.touchPoint.point.x,A=Math.abs(d.y-this.touchPoint.point.y);Math.abs(E)>this.swipeDistance&&A<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(E>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),m=!0),this.touchPoint=null}this.app.userStop(d,m)}},this.parentElement=t,t.classList.add("stf__parent"),t.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=t.querySelector(".stf__wrapper"),this.app=e;const n=this.app.getSettings().usePortrait?1:2;t.style.minWidth=i.minWidth*n+"px",t.style.minHeight=i.minHeight+"px",i.size==="fixed"&&(t.style.minWidth=i.width*n+"px",t.style.minHeight=i.height+"px"),i.autoSize&&(t.style.width="100%",t.style.maxWidth=2*i.maxWidth+"px"),t.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=i.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(t){this.wrapper.classList.remove("--portrait","--landscape"),t==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(t,e){const i=this.distElement.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}checkTarget(t){return!this.app.getSettings().clickEventForward||!["a","button"].includes(t.tagName.toLowerCase())}}class Rt extends V{constructor(t,e,i,n){super(t,e,i),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=t.querySelector(".stf__block"),this.items=n;for(const o of n)this.distElement.appendChild(o);this.setHandlers()}clear(){for(const t of this.items)this.parentElement.appendChild(t)}updateItems(t){this.removeHandlers(),this.distElement.innerHTML="";for(const e of t)this.distElement.appendChild(e);this.items=t,this.setHandlers()}update(){this.app.getRender().update()}}class Ct extends V{constructor(t,e,i){super(t,e,i),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=t.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=i}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class vt extends mt{constructor(t,e,i){super(t,e),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=i,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let i=(100-e)*(2.5*t.pageWidth)/100+20;i>t.pageWidth&&(i=t.pageWidth);let n=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${i}px;
            height: ${t.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*e/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;n+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=n}drawHardOuterShadow(){const t=this.getRect();let e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth);let i=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${e}px;
            height: ${t.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;i+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=i}drawInnerShadow(){const t=this.getRect(),e=3*this.shadow.width/4,i=this.getDirection()===0?e:0,n=this.getDirection()===0?"to left":"to right",o=this.convertToGlobal(this.shadow.pos),r=this.shadow.angle+3*Math.PI/2,d=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let m="polygon( ";for(const A of d){let U=this.getDirection()===1?{x:-A.x+this.shadow.pos.x,y:A.y-this.shadow.pos.y}:{x:A.x-this.shadow.pos.x,y:A.y-this.shadow.pos.y};U=y.GetRotatedPoint(U,{x:i,y:100},r),m+=U.x+"px "+U.y+"px, "}m=m.slice(0,-2),m+=")";const E=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${e}px;
            height: ${2*t.height}px;
            background: linear-gradient(${n},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${i}px 100px;
            transform: translate3d(${o.x-i}px, ${o.y-100}px, 0) rotate(${r}rad);
            clip-path: ${m};
            -webkit-clip-path: ${m};
        `;this.innerShadow.style.cssText=E}drawOuterShadow(){const t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.shadow.angle+3*Math.PI/2,n=this.getDirection()===1?this.shadow.width:0,o=this.getDirection()===0?"to right":"to left",r=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];let d="polygon( ";for(const E of r)if(E!==null){let A=this.getDirection()===1?{x:-E.x+this.shadow.pos.x,y:E.y-this.shadow.pos.y}:{x:E.x-this.shadow.pos.x,y:E.y-this.shadow.pos.y};A=y.GetRotatedPoint(A,{x:n,y:100},i),d+=A.x+"px "+A.y+"px, "}d=d.slice(0,-2),d+=")";const m=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*t.height}px;
            background: linear-gradient(${o}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${n}px 100px;
            transform: translate3d(${e.x-n}px, ${e.y-100}px, 0) rotate(${i}rad);
            clip-path: ${d};
            -webkit-clip-path: ${d};
        `;this.outerShadow.style.cssText=m}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const t=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const t of this.app.getPageCollection().getPages())t!==this.leftPage&&t!==this.rightPage&&t!==this.flippingPage&&t!==this.bottomPage&&(t.getElement().style.cssText="display: none"),t.getTemporaryCopy()!==this.flippingPage&&t.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class at{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(t){const e=this._default;if(Object.assign(e,t),e.size!=="stretch"&&e.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return e.size==="stretch"?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}(function(l,t){t===void 0&&(t={});var e=t.insertAt;if(typeof document<"u"){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=l:n.appendChild(document.createTextNode(l))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),f.PageFlip=class extends class{constructor(){this.events=new Map}on(l,t){return this.events.has(l)?this.events.get(l).push(t):this.events.set(l,[t]),this}off(l){this.events.delete(l)}trigger(l,t,e=null){if(this.events.has(l))for(const i of this.events.get(l))i({data:e,object:t})}}{constructor(l,t){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new at().getSettings(t),this.block=l}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(l){this.ui=new Ct(this.block,this,this.setting);const t=this.ui.getCanvas();this.render=new tt(this,this.setting,t),this.flipController=new I(this.render,this),this.pages=new L(this,this.render,l),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(l){this.ui=new Rt(this.block,this,this.setting,l),this.render=new vt(this,this.setting,this.ui.getDistElement()),this.flipController=new I(this.render,this),this.pages=new _(this,this.render,this.ui.getDistElement(),l),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(l){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new L(this,this.render,l),this.pages.load(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}updateFromHtml(l){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new _(this,this.render,this.ui.getDistElement(),l),this.pages.load(),this.ui.updateItems(l),this.render.reload(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(l){this.pages.show(l)}flipNext(l="top"){this.flipController.flipNext(l)}flipPrev(l="top"){this.flipController.flipPrev(l)}flip(l,t="top"){this.flipController.flipToPage(l,t)}updateState(l){this.trigger("changeState",this,l)}updatePageIndex(l){this.trigger("flip",this,l)}updateOrientation(l){this.ui.setOrientationStyle(l),this.update(),this.trigger("changeOrientation",this,l)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(l){return this.pages.getPage(l)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(l){this.mousePosition=l,this.isUserTouch=!0,this.isUserMove=!1}userMove(l,t){this.isUserTouch||t||!this.setting.showPageCorners?this.isUserTouch&&y.GetDistanceBetweenTwoPoint(this.mousePosition,l)>5&&(this.isUserMove=!0,this.flipController.fold(l)):this.flipController.showCorner(l)}userStop(l,t=!1){this.isUserTouch&&(this.isUserTouch=!1,t||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(l)))}},Object.defineProperty(f,"__esModule",{value:!0})})})(jt,jt.exports);var ii=jt.exports;const si=Z.forwardRef((g,h)=>{const f=H.useRef(null),c=H.useRef([]),w=H.useRef(),[P,L]=H.useState([]);H.useImperativeHandle(h,()=>({pageFlip:()=>w.current}));const y=H.useCallback(()=>{w.current&&w.current.clear()},[]),z=H.useCallback(()=>{const _=w.current;_&&(_.off("flip"),_.off("changeOrientation"),_.off("changeState"),_.off("init"),_.off("update"))},[]);return H.useEffect(()=>{if(c.current=[],g.children){const _=Z.Children.map(g.children,B=>Z.cloneElement(B,{ref:I=>{I&&c.current.push(I)}}));(!g.renderOnlyPageLengthChange||P.length!==_.length)&&(_.length<P.length&&y(),L(_))}},[g.children]),H.useEffect(()=>{const _=()=>{const B=w.current;B&&(g.onFlip&&B.on("flip",I=>g.onFlip(I)),g.onChangeOrientation&&B.on("changeOrientation",I=>g.onChangeOrientation(I)),g.onChangeState&&B.on("changeState",I=>g.onChangeState(I)),g.onInit&&B.on("init",I=>g.onInit(I)),g.onUpdate&&B.on("update",I=>g.onUpdate(I)))};P.length>0&&c.current.length>0&&(z(),f.current&&!w.current&&(w.current=new ii.PageFlip(f.current,g)),w.current.getFlipController()?w.current.updateFromHtml(c.current):w.current.loadFromHTML(c.current),_())},[P]),Z.createElement("div",{ref:f,className:g.className,style:g.style},P)}),ni=Z.memo(si),Pe=Z.forwardRef((g,h)=>T.jsx("div",{className:"page page-cover",ref:h,"data-density":"hard",children:T.jsx("div",{className:"page-content",children:T.jsx("h2",{children:g.children})})})),Ee=Z.forwardRef((g,h)=>T.jsx("div",{className:"page",ref:h,children:T.jsxs("div",{className:"page-content",children:[T.jsx("div",{className:"page-image"}),T.jsx("div",{className:"page-text",children:T.jsx("h2",{children:g.children})})]})}));class oi extends Z.Component{constructor(h){super(h),this.state={page:0,totalPage:0}}nextButtonClick=()=>{this.flipBook&&this.flipBook.getPageFlip().flipNext()};prevButtonClick=()=>{this.flipBook&&this.flipBook.getPageFlip().flipPrev()};onPage=h=>{this.setState({page:h.data})};componentDidMount(){this.flipBook&&this.flipBook.getPageFlip&&this.setState({totalPage:this.flipBook.getPageFlip().getPageCount()})}render(){const{greeting:h,designed_by:f}=this.props;return T.jsx("div",{children:T.jsxs(ni,{width:550,height:733,size:"stretch",minWidth:315,maxWidth:1e3,minHeight:400,maxHeight:1533,maxShadowOpacity:.5,showCover:!0,mobileScrollSupport:!0,onFlip:this.onPage,onChangeOrientation:this.onChangeOrientation,onChangeState:this.onChangeState,className:"demo-book",ref:c=>this.flipBook=c,children:[T.jsx(Pe,{children:T.jsx("img",{src:"/greetings-card/fathers_day.png",alt:"Cover",className:"cover-image"})}),T.jsx(Ee,{children:T.jsx("p",{})}),T.jsx(Ee,{children:T.jsx("div",{className:"greeting",children:h.split(`
`).map((c,w)=>T.jsx("p",{children:c.trim()===""?T.jsx(T.Fragment,{children:" "}):c},w))})}),T.jsx(Pe,{children:f.split(`
`).map((c,w)=>T.jsx("p",{children:c.trim()===""?T.jsx(T.Fragment,{children:" "}):c},w))})]})})}}/*! @license DOMPurify 3.1.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.5/LICENSE */const{entries:Oe,setPrototypeOf:_e,isFrozen:ri,getPrototypeOf:ai,getOwnPropertyDescriptor:hi}=Object;let{freeze:k,seal:G,create:Ne}=Object,{apply:Yt,construct:qt}=typeof Reflect<"u"&&Reflect;k||(k=function(h){return h});G||(G=function(h){return h});Yt||(Yt=function(h,f,c){return h.apply(f,c)});qt||(qt=function(h,f){return new h(...f)});const Pt=W(Array.prototype.forEach),be=W(Array.prototype.pop),pt=W(Array.prototype.push),bt=W(String.prototype.toLowerCase),Bt=W(String.prototype.toString),Ae=W(String.prototype.match),dt=W(String.prototype.replace),li=W(String.prototype.indexOf),ci=W(String.prototype.trim),$=W(Object.prototype.hasOwnProperty),N=W(RegExp.prototype.test),ut=gi(TypeError);function W(g){return function(h){for(var f=arguments.length,c=new Array(f>1?f-1:0),w=1;w<f;w++)c[w-1]=arguments[w];return Yt(g,h,c)}}function gi(g){return function(){for(var h=arguments.length,f=new Array(h),c=0;c<h;c++)f[c]=arguments[c];return qt(g,f)}}function x(g,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bt;_e&&_e(g,null);let c=h.length;for(;c--;){let w=h[c];if(typeof w=="string"){const P=f(w);P!==w&&(ri(h)||(h[c]=P),w=P)}g[w]=!0}return g}function pi(g){for(let h=0;h<g.length;h++)$(g,h)||(g[h]=null);return g}function Q(g){const h=Ne(null);for(const[f,c]of Oe(g))$(g,f)&&(Array.isArray(c)?h[f]=pi(c):c&&typeof c=="object"&&c.constructor===Object?h[f]=Q(c):h[f]=c);return h}function Et(g,h){for(;g!==null;){const c=hi(g,h);if(c){if(c.get)return W(c.get);if(typeof c.value=="function")return W(c.value)}g=ai(g)}function f(){return null}return f}const Re=k(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ut=k(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Gt=k(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),di=k(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zt=k(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ui=k(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ce=k(["#text"]),ve=k(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),$t=k(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ie=k(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),_t=k(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fi=G(/\{\{[\w\W]*|[\w\W]*\}\}/gm),mi=G(/<%[\w\W]*|[\w\W]*%>/gm),wi=G(/\${[\w\W]*}/gm),xi=G(/^data-[\-\w.\u00B7-\uFFFF]/),yi=G(/^aria-[\-\w]+$/),ke=G(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Si=G(/^(?:\w+script|data):/i),Ti=G(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Fe=G(/^html$/i),Pi=G(/^[a-z][.\w]*(-[.\w]+)+$/i);var De=Object.freeze({__proto__:null,MUSTACHE_EXPR:fi,ERB_EXPR:mi,TMPLIT_EXPR:wi,DATA_ATTR:xi,ARIA_ATTR:yi,IS_ALLOWED_URI:ke,IS_SCRIPT_OR_DATA:Si,ATTR_WHITESPACE:Ti,DOCTYPE_NAME:Fe,CUSTOM_ELEMENT:Pi});const ft={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Ei=function(){return typeof window>"u"?null:window},_i=function(h,f){if(typeof h!="object"||typeof h.createPolicy!="function")return null;let c=null;const w="data-tt-policy-suffix";f&&f.hasAttribute(w)&&(c=f.getAttribute(w));const P="dompurify"+(c?"#"+c:"");try{return h.createPolicy(P,{createHTML(L){return L},createScriptURL(L){return L}})}catch{return console.warn("TrustedTypes policy "+P+" could not be created."),null}};function He(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ei();const h=u=>He(u);if(h.version="3.1.5",h.removed=[],!g||!g.document||g.document.nodeType!==ft.document)return h.isSupported=!1,h;let{document:f}=g;const c=f,w=c.currentScript,{DocumentFragment:P,HTMLTemplateElement:L,Node:y,Element:z,NodeFilter:_,NamedNodeMap:B=g.NamedNodeMap||g.MozNamedAttrMap,HTMLFormElement:I,DOMParser:mt,trustedTypes:tt}=g,V=z.prototype,Rt=Et(V,"cloneNode"),Ct=Et(V,"nextSibling"),vt=Et(V,"childNodes"),at=Et(V,"parentNode");if(typeof L=="function"){const u=f.createElement("template");u.content&&u.content.ownerDocument&&(f=u.content.ownerDocument)}let l,t="";const{implementation:e,createNodeIterator:i,createDocumentFragment:n,getElementsByTagName:o}=f,{importNode:r}=c;let d={};h.isSupported=typeof Oe=="function"&&typeof at=="function"&&e&&e.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:m,ERB_EXPR:E,TMPLIT_EXPR:A,DATA_ATTR:U,ARIA_ATTR:K,IS_SCRIPT_OR_DATA:We,ATTR_WHITESPACE:Xt,CUSTOM_ELEMENT:Be}=De;let{IS_ALLOWED_URI:Zt}=De,R=null;const Vt=x({},[...Re,...Ut,...Gt,...zt,...Ce]);let C=null;const Kt=x({},[...ve,...$t,...Ie,..._t]);let b=Object.seal(Ne(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ht=null,It=null,Jt=!0,Dt=!0,Qt=!1,te=!0,et=!1,Lt=!0,J=!1,Mt=!1,Ot=!1,it=!1,wt=!1,xt=!1,ee=!0,ie=!1;const Ue="user-content-";let Nt=!0,lt=!1,st={},nt=null;const se=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ne=null;const oe=x({},["audio","video","img","source","image","track"]);let kt=null;const re=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),yt="http://www.w3.org/1998/Math/MathML",St="http://www.w3.org/2000/svg",q="http://www.w3.org/1999/xhtml";let ot=q,Ft=!1,Ht=null;const Ge=x({},[yt,St,q],Bt);let ct=null;const ze=["application/xhtml+xml","text/html"],$e="text/html";let v=null,rt=null;const je=f.createElement("form"),ae=function(s){return s instanceof RegExp||s instanceof Function},Wt=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(rt&&rt===s)){if((!s||typeof s!="object")&&(s={}),s=Q(s),ct=ze.indexOf(s.PARSER_MEDIA_TYPE)===-1?$e:s.PARSER_MEDIA_TYPE,v=ct==="application/xhtml+xml"?Bt:bt,R=$(s,"ALLOWED_TAGS")?x({},s.ALLOWED_TAGS,v):Vt,C=$(s,"ALLOWED_ATTR")?x({},s.ALLOWED_ATTR,v):Kt,Ht=$(s,"ALLOWED_NAMESPACES")?x({},s.ALLOWED_NAMESPACES,Bt):Ge,kt=$(s,"ADD_URI_SAFE_ATTR")?x(Q(re),s.ADD_URI_SAFE_ATTR,v):re,ne=$(s,"ADD_DATA_URI_TAGS")?x(Q(oe),s.ADD_DATA_URI_TAGS,v):oe,nt=$(s,"FORBID_CONTENTS")?x({},s.FORBID_CONTENTS,v):se,ht=$(s,"FORBID_TAGS")?x({},s.FORBID_TAGS,v):{},It=$(s,"FORBID_ATTR")?x({},s.FORBID_ATTR,v):{},st=$(s,"USE_PROFILES")?s.USE_PROFILES:!1,Jt=s.ALLOW_ARIA_ATTR!==!1,Dt=s.ALLOW_DATA_ATTR!==!1,Qt=s.ALLOW_UNKNOWN_PROTOCOLS||!1,te=s.ALLOW_SELF_CLOSE_IN_ATTR!==!1,et=s.SAFE_FOR_TEMPLATES||!1,Lt=s.SAFE_FOR_XML!==!1,J=s.WHOLE_DOCUMENT||!1,it=s.RETURN_DOM||!1,wt=s.RETURN_DOM_FRAGMENT||!1,xt=s.RETURN_TRUSTED_TYPE||!1,Ot=s.FORCE_BODY||!1,ee=s.SANITIZE_DOM!==!1,ie=s.SANITIZE_NAMED_PROPS||!1,Nt=s.KEEP_CONTENT!==!1,lt=s.IN_PLACE||!1,Zt=s.ALLOWED_URI_REGEXP||ke,ot=s.NAMESPACE||q,b=s.CUSTOM_ELEMENT_HANDLING||{},s.CUSTOM_ELEMENT_HANDLING&&ae(s.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=s.CUSTOM_ELEMENT_HANDLING.tagNameCheck),s.CUSTOM_ELEMENT_HANDLING&&ae(s.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=s.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),s.CUSTOM_ELEMENT_HANDLING&&typeof s.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=s.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),et&&(Dt=!1),wt&&(it=!0),st&&(R=x({},Ce),C=[],st.html===!0&&(x(R,Re),x(C,ve)),st.svg===!0&&(x(R,Ut),x(C,$t),x(C,_t)),st.svgFilters===!0&&(x(R,Gt),x(C,$t),x(C,_t)),st.mathMl===!0&&(x(R,zt),x(C,Ie),x(C,_t))),s.ADD_TAGS&&(R===Vt&&(R=Q(R)),x(R,s.ADD_TAGS,v)),s.ADD_ATTR&&(C===Kt&&(C=Q(C)),x(C,s.ADD_ATTR,v)),s.ADD_URI_SAFE_ATTR&&x(kt,s.ADD_URI_SAFE_ATTR,v),s.FORBID_CONTENTS&&(nt===se&&(nt=Q(nt)),x(nt,s.FORBID_CONTENTS,v)),Nt&&(R["#text"]=!0),J&&x(R,["html","head","body"]),R.table&&(x(R,["tbody"]),delete ht.tbody),s.TRUSTED_TYPES_POLICY){if(typeof s.TRUSTED_TYPES_POLICY.createHTML!="function")throw ut('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof s.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ut('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');l=s.TRUSTED_TYPES_POLICY,t=l.createHTML("")}else l===void 0&&(l=_i(tt,w)),l!==null&&typeof t=="string"&&(t=l.createHTML(""));k&&k(s),rt=s}},he=x({},["mi","mo","mn","ms","mtext"]),le=x({},["foreignobject","annotation-xml"]),Ye=x({},["title","style","font","a","script"]),ce=x({},[...Ut,...Gt,...di]),ge=x({},[...zt,...ui]),qe=function(s){let a=at(s);(!a||!a.tagName)&&(a={namespaceURI:ot,tagName:"template"});const p=bt(s.tagName),S=bt(a.tagName);return Ht[s.namespaceURI]?s.namespaceURI===St?a.namespaceURI===q?p==="svg":a.namespaceURI===yt?p==="svg"&&(S==="annotation-xml"||he[S]):!!ce[p]:s.namespaceURI===yt?a.namespaceURI===q?p==="math":a.namespaceURI===St?p==="math"&&le[S]:!!ge[p]:s.namespaceURI===q?a.namespaceURI===St&&!le[S]||a.namespaceURI===yt&&!he[S]?!1:!ge[p]&&(Ye[p]||!ce[p]):!!(ct==="application/xhtml+xml"&&Ht[s.namespaceURI]):!1},j=function(s){pt(h.removed,{element:s});try{s.parentNode.removeChild(s)}catch{s.remove()}},Tt=function(s,a){try{pt(h.removed,{attribute:a.getAttributeNode(s),from:a})}catch{pt(h.removed,{attribute:null,from:a})}if(a.removeAttribute(s),s==="is"&&!C[s])if(it||wt)try{j(a)}catch{}else try{a.setAttribute(s,"")}catch{}},pe=function(s){let a=null,p=null;if(Ot)s="<remove></remove>"+s;else{const D=Ae(s,/^[\r\n\t ]+/);p=D&&D[0]}ct==="application/xhtml+xml"&&ot===q&&(s='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+s+"</body></html>");const S=l?l.createHTML(s):s;if(ot===q)try{a=new mt().parseFromString(S,ct)}catch{}if(!a||!a.documentElement){a=e.createDocument(ot,"template",null);try{a.documentElement.innerHTML=Ft?t:S}catch{}}const M=a.body||a.documentElement;return s&&p&&M.insertBefore(f.createTextNode(p),M.childNodes[0]||null),ot===q?o.call(a,J?"html":"body")[0]:J?a.documentElement:M},de=function(s){return i.call(s.ownerDocument||s,s,_.SHOW_ELEMENT|_.SHOW_COMMENT|_.SHOW_TEXT|_.SHOW_PROCESSING_INSTRUCTION|_.SHOW_CDATA_SECTION,null)},ue=function(s){return s instanceof I&&(typeof s.nodeName!="string"||typeof s.textContent!="string"||typeof s.removeChild!="function"||!(s.attributes instanceof B)||typeof s.removeAttribute!="function"||typeof s.setAttribute!="function"||typeof s.namespaceURI!="string"||typeof s.insertBefore!="function"||typeof s.hasChildNodes!="function")},fe=function(s){return typeof y=="function"&&s instanceof y},X=function(s,a,p){d[s]&&Pt(d[s],S=>{S.call(h,a,p,rt)})},me=function(s){let a=null;if(X("beforeSanitizeElements",s,null),ue(s))return j(s),!0;const p=v(s.nodeName);if(X("uponSanitizeElement",s,{tagName:p,allowedTags:R}),s.hasChildNodes()&&!fe(s.firstElementChild)&&N(/<[/\w]/g,s.innerHTML)&&N(/<[/\w]/g,s.textContent)||s.nodeType===ft.progressingInstruction||Lt&&s.nodeType===ft.comment&&N(/<[/\w]/g,s.data))return j(s),!0;if(!R[p]||ht[p]){if(!ht[p]&&xe(p)&&(b.tagNameCheck instanceof RegExp&&N(b.tagNameCheck,p)||b.tagNameCheck instanceof Function&&b.tagNameCheck(p)))return!1;if(Nt&&!nt[p]){const S=at(s)||s.parentNode,M=vt(s)||s.childNodes;if(M&&S){const D=M.length;for(let F=D-1;F>=0;--F){const Y=Rt(M[F],!0);Y.__removalCount=(s.__removalCount||0)+1,S.insertBefore(Y,Ct(s))}}}return j(s),!0}return s instanceof z&&!qe(s)||(p==="noscript"||p==="noembed"||p==="noframes")&&N(/<\/no(script|embed|frames)/i,s.innerHTML)?(j(s),!0):(et&&s.nodeType===ft.text&&(a=s.textContent,Pt([m,E,A],S=>{a=dt(a,S," ")}),s.textContent!==a&&(pt(h.removed,{element:s.cloneNode()}),s.textContent=a)),X("afterSanitizeElements",s,null),!1)},we=function(s,a,p){if(ee&&(a==="id"||a==="name")&&(p in f||p in je))return!1;if(!(Dt&&!It[a]&&N(U,a))){if(!(Jt&&N(K,a))){if(!C[a]||It[a]){if(!(xe(s)&&(b.tagNameCheck instanceof RegExp&&N(b.tagNameCheck,s)||b.tagNameCheck instanceof Function&&b.tagNameCheck(s))&&(b.attributeNameCheck instanceof RegExp&&N(b.attributeNameCheck,a)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(a))||a==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&N(b.tagNameCheck,p)||b.tagNameCheck instanceof Function&&b.tagNameCheck(p))))return!1}else if(!kt[a]){if(!N(Zt,dt(p,Xt,""))){if(!((a==="src"||a==="xlink:href"||a==="href")&&s!=="script"&&li(p,"data:")===0&&ne[s])){if(!(Qt&&!N(We,dt(p,Xt,"")))){if(p)return!1}}}}}}return!0},xe=function(s){return s!=="annotation-xml"&&Ae(s,Be)},ye=function(s){X("beforeSanitizeAttributes",s,null);const{attributes:a}=s;if(!a)return;const p={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:C};let S=a.length;for(;S--;){const M=a[S],{name:D,namespaceURI:F,value:Y}=M,gt=v(D);let O=D==="value"?Y:ci(Y);if(p.attrName=gt,p.attrValue=O,p.keepAttr=!0,p.forceKeepAttr=void 0,X("uponSanitizeAttribute",s,p),O=p.attrValue,p.forceKeepAttr||(Tt(D,s),!p.keepAttr))continue;if(!te&&N(/\/>/i,O)){Tt(D,s);continue}if(Lt&&N(/((--!?|])>)|<\/(style|title)/i,O)){Tt(D,s);continue}et&&Pt([m,E,A],Te=>{O=dt(O,Te," ")});const Se=v(s.nodeName);if(we(Se,gt,O)){if(ie&&(gt==="id"||gt==="name")&&(Tt(D,s),O=Ue+O),l&&typeof tt=="object"&&typeof tt.getAttributeType=="function"&&!F)switch(tt.getAttributeType(Se,gt)){case"TrustedHTML":{O=l.createHTML(O);break}case"TrustedScriptURL":{O=l.createScriptURL(O);break}}try{F?s.setAttributeNS(F,D,O):s.setAttribute(D,O),ue(s)?j(s):be(h.removed)}catch{}}}X("afterSanitizeAttributes",s,null)},Xe=function u(s){let a=null;const p=de(s);for(X("beforeSanitizeShadowDOM",s,null);a=p.nextNode();)X("uponSanitizeShadowNode",a,null),!me(a)&&(a.content instanceof P&&u(a.content),ye(a));X("afterSanitizeShadowDOM",s,null)};return h.sanitize=function(u){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=null,p=null,S=null,M=null;if(Ft=!u,Ft&&(u="<!-->"),typeof u!="string"&&!fe(u))if(typeof u.toString=="function"){if(u=u.toString(),typeof u!="string")throw ut("dirty is not a string, aborting")}else throw ut("toString is not a function");if(!h.isSupported)return u;if(Mt||Wt(s),h.removed=[],typeof u=="string"&&(lt=!1),lt){if(u.nodeName){const Y=v(u.nodeName);if(!R[Y]||ht[Y])throw ut("root node is forbidden and cannot be sanitized in-place")}}else if(u instanceof y)a=pe("<!---->"),p=a.ownerDocument.importNode(u,!0),p.nodeType===ft.element&&p.nodeName==="BODY"||p.nodeName==="HTML"?a=p:a.appendChild(p);else{if(!it&&!et&&!J&&u.indexOf("<")===-1)return l&&xt?l.createHTML(u):u;if(a=pe(u),!a)return it?null:xt?t:""}a&&Ot&&j(a.firstChild);const D=de(lt?u:a);for(;S=D.nextNode();)me(S)||(S.content instanceof P&&Xe(S.content),ye(S));if(lt)return u;if(it){if(wt)for(M=n.call(a.ownerDocument);a.firstChild;)M.appendChild(a.firstChild);else M=a;return(C.shadowroot||C.shadowrootmode)&&(M=r.call(c,M,!0)),M}let F=J?a.outerHTML:a.innerHTML;return J&&R["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&N(Fe,a.ownerDocument.doctype.name)&&(F="<!DOCTYPE "+a.ownerDocument.doctype.name+`>
`+F),et&&Pt([m,E,A],Y=>{F=dt(F,Y," ")}),l&&xt?l.createHTML(F):F},h.setConfig=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wt(u),Mt=!0},h.clearConfig=function(){rt=null,Mt=!1},h.isValidAttribute=function(u,s,a){rt||Wt({});const p=v(u),S=v(s);return we(p,S,a)},h.addHook=function(u,s){typeof s=="function"&&(d[u]=d[u]||[],pt(d[u],s))},h.removeHook=function(u){if(d[u])return be(d[u])},h.removeHooks=function(u){d[u]&&(d[u]=[])},h.removeAllHooks=function(){d={}},h}var bi=He();const Ai=()=>{const[g,h]=H.useState(""),[f,c]=H.useState("");return H.useEffect(()=>{const P=new URLSearchParams(window.location.search).get("greeting");if(P){const L=bi.sanitize(atob(P)),[y,z]=L.split("---");h(y.trim()),c(z?z.trim():"")}},[]),T.jsx(oi,{greeting:g,designed_by:f})},Ci=()=>T.jsx("div",{className:"app",children:T.jsx(Ai,{})});export{Ci as default};
